# Расстояние вращения

Драйверы шаговых двигателей на Klipper требуют параметра `rotation_distance` в каждом [разделе конфигурации шагового двигателя](Config_Reference.md#stepper). `rotation_distance ` - это расстояние, на которое ось перемещается за один полный оборот шагового двигателя. В этом документе описано, как можно настроить это значение.

## Obtaining rotation_distance from steps_per_mm (or step_distance)
Получение rotation_distance из steps_per_mm (или step_distance)

Дизайнеры вашего 3d-принтера изначально рассчитали `step_пер_мм` с расстояния поворота. Если вы знаете steps_per_mm, то можно использовать эту общую формулу для получения исходного расстояния поворота:
```
rotation_distance = <full_steps_per_rotation> * <microsteps> / <steps_per_mm>
```

Или, если у вас более старая конфигурация Klipper и вы знаете параметр `step_distance`, вы можете использовать эту формулу:
```
rotation_distance = <full_steps_per_rotation> * <microsteps> * <step_distance>
```

Параметр `<full_steps_per_rotation>` определяется типом шагового двигателя. Большинство шаговых двигателей являются `шаговыми двигателями на 1,8 градуса` и, следовательно, имеют 200 полных шагов на оборот (360, деленное на 1,8, равно 200). Некоторые шаговые двигатели являются `шаговыми двигателями на 0,9 градуса` и, таким образом, имеют 400 полных шагов на оборот. Другие шаговые двигатели встречаются редко. Если вы не уверены, не устанавливайте full_steps_per_rotation в файле конфигурации и используйте 200 в приведенной выше формуле.

Настройка `<микрошагов>` определяется драйвером шагового двигателя. Большинство водителей используют 16 микрошагов. Если вы не уверены, установите `микрошагов: 16` в конфигурации и используйте 16 в приведенной выше формуле.

Почти все принтеры должны иметь целое число для `rotation_distance` на осях типа x, y и z. Если приведенная выше формула приводит к значению rotation_distance, которое находится в пределах 0,01 от целого числа, затем округлите конечное значение до этого целого числа.

## Calibrating rotation_distance on extruders
Калибровка сопротивления вращению на экструдерах

На экструдере `расстояние вращения` - это расстояние, на которое проходит нить накала за один полный оборот шагового двигателя. Лучший способ получить точное значение для этого параметра-использовать процедуру `измерение и обрезка`.

Сначала начните с первоначального предположения о расстоянии поворота. Это может быть получено из [steps_per_mm](#obtaining-rotation_distance-from-steps_per_mm-or-step_distance) или путем [проверки оборудования](#extruder).
Затем используйте следующую процедуру для `измерения и обрезки`:
1. Убедитесь, что в экструдере есть нить накала, нагреватель нагрет до соответствующей температуры и принтер готов к выдавливанию.
2. С помощью маркера нанесите метку на нить накала примерно в 70 мм от впускного отверстия корпуса экструдера. Затем используйте цифровой штангенциркуль, чтобы как можно точнее измерить фактическое расстояние до этой отметки. Обратите внимание на это как `<initial_mark_distance>`.
3. Вытяните 50 мм нити накала со следующей последовательностью команд: `G91`, за которым следует `G1 E50 F60`. Обратите внимание на 50 мм как `<requested_extrude_distance>`. Подождите, пока экструдер завершит перемещение (это займет около 50 секунд).
4. Используйте цифровые штангенциркули для измерения нового расстояния между корпусом экструдера и меткой на нити накала. Обратите внимание на это как  `<subsequent_mark_distance>`. Затем вычислите:  
   `actual_extrude_distance = <initial_mark_distance> - <subsequent_mark_distance>`
5. Вычислите rotation_distance как:
   `rotation_distance = <previous_rotation_distance> * <actual_extrude_distance> / <requested_extrude_distance>`
   Вокруг нового значения rotation_distance до трех знаков после запятой.

Если фактическое расстояние экструзии `actual_extrude_distance` отличается от запрошенного расстояния экструзии `requested_extrude_distance` более чем на 2 мм, то рекомендуется выполнить описанные выше действия во второй раз.

Примечание. *Не* используйте метод  "measure and trim" для калибровки осей типа x, y или z. Метод  "measure and trim" недостаточно точен для этих осей и, скорее всего, приведет к ухудшению конфигурации. Вместо этого, при необходимости, эти оси могут быть определены с помощью [measuring the belts, pulleys, and lead screw hardware](#obtaining-rotation_distance-by-inspecting-the-hardware).

## Obtaining rotation_distance by inspecting the hardware
Получение rotation_distance путем проверки оборудования

Можно рассчитать расстояние вращения, зная шаговые двигатели и кинематику принтера. Это может быть полезно, если значение steps_per_mm неизвестно или при разработке нового принтера.

### Belt driven axes
Оси с ременным приводом

Легко рассчитать расстояние поворота для линейной оси, на которой используются ремень и шкив.

Сначала определите тип ремня. Большинство принтеров используют шаг ленты 2 мм (то есть каждый зуб на ленте находится на расстоянии 2 мм друг от друга). Затем подсчитайте количество зубьев на шкиве шагового двигателя. Затем значение rotation_distance вычисляется как:
```
rotation_distance = <belt_pitch> * <number_of_teeth_on_pulley>
```

Например, если принтер оснащен 2-миллиметровым ремнем и использует шкив с 20 зубьями, то расстояние вращения составляет 40.

### Оси с ходовым винтом

Легко рассчитать сопротивление вращению для обычных ходовых винтов, используя следующую формулу:
```
rotation_distance = <screw_pitch> * <number_of_separate_threads>
```

Например, обычный ходовой винт T8 имеет расстояние вращения 8 (он имеет шаг 2 мм и имеет 4 отдельные резьбы).

Старые принтеры с "резьбовыми стержнями" имеют только одну "резьбу" на ходовом винте, и, таким образом, расстояние вращения равно шагу винта. (Шаг винта-это расстояние между каждой канавкой на винте.) Так, например, метрический стержень M6 имеет расстояние вращения 1, а стержень M8 имеет расстояние вращения 1,25.

### Extruder

Начальное расстояние вращения экструдеров можно получить, измерив диаметр "заточенного болта", который толкает нить накала, и используя следующую формулу: `rotation_distance = <diameter> * 3.14`

Если экструдер использует шестерни, то также необходимо будет [определить и установить передаточное число](#using-a-gear_ratio) для экструдера.

Фактическое расстояние вращения экструдера будет варьироваться от принтера к принтеру, поскольку захват "заточенного болта", который входит в зацепление с нитью накала, может варьироваться. Он может даже варьироваться между катушками нити накала. После получения начального значения сопротивления вращению используйте [процедуру измерения и обрезки](#calibrating-rotation_distance-on-extruders) для получения более точной настройки.

## Using a gear_ratio
Использование передаточного числа

Установка `gear_ratio` может упростить настройку `rotation_distance` на шаговых двигателях, к которым подключена коробка передач (или аналогичная). У большинства степперов нет коробки передач - если вы не уверены, не устанавливайте `gear_ratio` в конфигурации.

Когда задано значение `gear_ratio`, значение `rotation_distance` представляет расстояние, на которое перемещается ось при одном полном вращении конечной передачи в коробке передач. Если, например, используется коробка передач с соотношением "5:1", то можно рассчитать сопротивление вращению с помощью [знания оборудования](#obtaining-rotation_distance-by-inspecting-the-hardware), а затем добавить `gear_ratio: 5:1` в конфигурацию.

Для передачи, выполненной с ремнями и шкивами, можно определить соотношение передач, подсчитав зубья на шкивах. Например, если шаговый механизм с 16 зубчатым шкивом приводит в движение следующий шкив с 80 зубьями, то можно использовать `gear_ratio: 80:16`. Действительно, можно было бы открыть обычную готовую "gear box" (коробку передач) и посчитать в ней зубья, чтобы подтвердить ее передаточное число.

Обратите внимание, что иногда коробка передач будет иметь немного другое передаточное число, чем то, как она рекламируется. Примером этого являются обычные мотор - редукторы экструдера BMG-они рекламируются как "3:1", но на самом деле используют передачу "50:17". (Использование чисел зубьев без общего знаменателя может улучшить общий износ зубчатого колеса, поскольку зубья не всегда сходятся одинаково при каждом обороте.) Обычная "планетарная коробка передач 5.18:1" более точно настроена с помощью `gear_ratio: 57:11`.

Если на оси используется несколько шестерен, то можно предоставить gear_ratio список, разделенный запятыми. Например, коробка передач "5:1", приводящая в движение шкив с 16 зубьями до 80 зубьев, может использовать `gear_ratio: 5:1, 80:16`.

В большинстве случаев gear_ratio следует определять целыми числами, так как на обычных шестернях и шкивах имеется целое число зубьев. Однако в тех случаях, когда ремень приводит в движение шкив, используя трение вместо зубьев, может иметь смысл использовать число с плавающей запятой в передаточном числе (например, `gear_ratio: 107.237:16`).
